# 200917.数组类型

如果我们有一组类型相同的变量，例如，5位同学的成绩，可以这么写：
```java
public class Main {
    public static void main(String[] args) {
        // 5位同学的成绩:
        int n1 = 68;
        int n2 = 79;
        int n3 = 91;
        int n4 = 85;
        int n5 = 62;
    }
}
```

但其实没有必要定义5个int变量。可以使用数组来表示“一组”int类型
代码如下：
```java
public class Main {
    public static void main(String[] args) {
        // 5位同学的成绩:
        int[] ns = new int[5];
        ns[0] = 68;
        ns[1] = 79;
        ns[2] = 91;
        ns[3] = 85;
        ns[4] = 62;   
    }
}
```

定义一个数组类型的变量，使用数组类型“类型[]”，例如，int[]
和单个基本类型变量不同，数组变量初始化必须使用new int[5]表示创建一个可容纳5个int元素的数组

> 格式：variable_type[] array_name = new variable_type[array_size]  

> 初始化：variable_type[] array_name = {some elements...} 

***Java数组中不仅可以包含普通变量，也可以包含一组对象实例（使用new操作符创建）***
当然，对于对象分配来说，必须都是同一个class（同一数据类型）

Java的数组有几个特点：
1. 数组所有元素初始化为默认值，整型都是0，浮点型是0.0，布尔型是false；
2. 数组一旦创建后，大小就不可改变。
3. 要访问数组中的某一个元素，需要使用索引。数组索引从0开始，例如，5个元素的数组，索引范围是0~4。

可以修改数组中的某一个元素，使用赋值语句，例如，ns[1] = 79
可以用[数组变量.length]获取数组大小：

```java
public class Main {
    public static void main(String[] args) {
        // 5位同学的成绩:
        int[] ns = new int[5];
        System.out.println(ns.length); // 5
    }
}
```

数组是引用类型，在使用索引访问数组元素时，
如果索引超出范围，运行时将报错：
```java
public class Main {
    public static void main(String[] args) {
        // 5位同学的成绩:
        int[] ns = new int[5];
        int n = 5;
        System.out.println(ns[n]); // 索引n不能超出范围 (0-4)
    }
}
```

在定义数组时直接指定初始化的元素，这样就不必写出数组大小  
而是由编译器自动推算数组大小：
```java
public class Main {
    public static void main(String[] args) {
        // 5位同学的成绩:
        int[] ns = new int[] { 68, 79, 91, 85, 62 };
        System.out.println(ns.length); // 编译器自动推算数组大小为5
    }
}
```

还可以进一步简写为：
```java
int[] ns = { 68, 79, 91, 85, 62 };
```

## 引用类型
注意数组是引用类型，并且数组大小不可变。我们观察下面的代码：
```java
public class Main {
    public static void main(String[] args) {
        // 5位同学的成绩:
        int[] ns;
        ns = new int[] { 68, 79, 91, 85, 62 };
        System.out.println(ns.length); // 5

        ns = new int[] { 1, 2, 3 };
        System.out.println(ns.length); // 3
    }
}
```
上面的代码实际上修改了数组指向的位置  
对于数组ns来说，执行ns = new int[] { 68, 79, 91, 85, 62 };  
时它指向一个5个元素的数组：

执行ns = new int[] { 1, 2, 3 };时，它指向一个新的3个元素的数组：

但是，原有的5个元素的数组并没有改变，只是无法通过变量ns引用到它们而已。

如果数组元素不是基本类型，而是一个引用类型，那么，修改数组元素会有哪些不同？
字符串是引用类型，因此我们先定义一个字符串数组：
```java
String[] names = {
    "ABC", "XYZ", "zoo"
};
```
对于String[]类型的数组变量names，它实际上包含3个元素  
但每个元素都指向某个字符串对象：

对names[1]进行赋值，例如names[1] = "cat";，效果如下：

这里注意到原来names[1]指向的字符串"XYZ"并没有改变  
仅仅是将names[1]的引用从指向"XYZ"改成了指向"cat"  
其结果是字符串"XYZ"再也无法通过names[1]访问到了

对“指向”有了更深入的理解后，解释如下代码：
```java
public class Main {
    public static void main(String[] args) {
        String[] names = {"ABC", "XYZ", "zoo"};
        String s = names[1];
        names[1] = "cat";
        System.out.println(s); // s是"XYZ"还是"cat"?

        //验证：遍历数组元素
        for (int i = 0; i < names.length; i++)
            System.out.println(names[i]);
    }
}
```
>改变指向后，无法通过name[1]这样的数组索引访问元素了  
但是在给name[1]重定向之前，使用了String s对原names[1]元素进行了引用     
所以依然可以通过s来访问names[1]原来的元素"XYZ"

## 遍历数组：for-each循环：
```java
public class Main {
    public static void main(String[] args) {
        int[] ns = { 1, 4, 9, 16, 25 };
        for (int n : ns) {
            System.out.println(n);
        }
    }
}
```

> 格式：for (temp_variable : array_name)   
**访问时使用temp_variable直接对元素进行取出**

与常见的for循环不同的是，for循环是通过循环控制变量下标，访问数组中的不同位置处的元素进行遍历  

而for-each循环是通过与数组内元素类型相同的变量进行遍历，直接得到数组内从下标为0的位置至最后一个位置的元素的元素值，便于数组内元素的查找  

比如在数组内只需要找到是否有某个元素，而不用返回元素对应的数组下标是，for-each循环是一个不错的选择

## 二维数组
二维数组就是数组的数组。定义一个二维数组如下：
```java
// 二维数组
public class Main {
    public static void main(String[] args) {
        int[][] ns = {
            { 1, 2, 3, 4 },
            { 5, 6, 7, 8 },
            { 9, 10, 11, 12 }
        };

        System.out.println(ns.length); // 3
    }
}
```

因为ns包含3个数组，因此，ns.length为3。实际上ns在内存中的结构如下：  

如果我们定义一个普通数组arr0，然后把ns[0]赋值给它：
```java
// 二维数组
public class Main {
    public static void main(String[] args) {
        int[][] ns = {
            { 1, 2, 3, 4 },
            { 5, 6, 7, 8 },
            { 9, 10, 11, 12 }
        };

        int[] arr0 = ns[0];
        System.out.println(arr0.length); // 4
    }
}
```

实际上arr0就获取了ns数组的第0个元素  
因为ns数组的每个元素也是一个数组  
因此，arr0指向的数组就是{ 1, 2, 3, 4 }。在内存中，结构如下：

访问二维数组的某个元素需要使用array[row][col]，例如：  
```java
System.out.println(ns[1][2]); // 7
```

二维数组的每个数组元素的长度并不要求相同，例如，可以这么定义ns数组：
```java
int[][] ns = {
    { 1, 2, 3, 4 },
    { 5, 6 },
    { 7, 8, 9 }
};
```

这个二维数组在内存中的结构如下：

要打印一个二维数组，可以使用两层嵌套的for循环：
```java
for (int[] arr : ns) {
    for (int n : arr) {
        System.out.print(n);
        System.out.print(', ');
    }

    System.out.println();
}
```
或者使用Java标准库的`Arrays.deepToString()`：
```java
import java.util.Arrays;

public class Main {
    public static void main(String[] args) {
        int[][] ns = {
            { 1, 2, 3, 4 },
            { 5, 6, 7, 8 },
            { 9, 10, 11, 12 }
        };

        System.out.println(Arrays.deepToString(ns));
    }
}
```

## 三维数组
三维数组就是二维数组的数组。可以这么定义一个三维数组：  
```java
int[][][] ns = {
    {
        {1, 2, 3},
        {4, 5, 6},
        {7, 8, 9}
    },

    {
        {10, 11},
        {12, 13}
    },

    {
        {14, 15, 16},
        {17, 18}
    }
};
```
它在内存中的结构如下：  

如果我们要访问三维数组的某个元素，例如，ns[2][0][1]，只需要顺着定位找到对应的最终元素15即可  
理论上，我们可以定义任意的N维数组。但在实际应用中，除了二维数组在某些时候还能用得上，更高维度的数组很少使用  

## 小结
* 数组是同一数据类型的集合，数组一旦创建后，大小就不可变
可以通过索引访问数组元素，但索引超出范围将报错
* 数组元素可以是值类型（如int）或引用类型（如String），但数组本身是引用类型
* 二维数组就是数组的数组，三维数组就是二维数组的数组
* 多维数组的每个数组元素长度都不要求相同
* 打印多维数组可以使用Arrays.deepToString()
* 最常见的多维数组是二维数组，访问二维数组的一个元素使用array[row][col]
